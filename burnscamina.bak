(require (lib "graphics.ss" "graphics"))
(open-graphics)

(define fondo (open-pixmap "fondo" (make-posn 800 389)))
(define ventana (open-viewport "burns" (make-posn 800 389)))
((draw-pixmap ventana) "back3.png" (make-posn 0 0))
(define z1 "z1.png")
(define mov1 "b1.png")
(define mov2 "b2.png")
(define mov3 "b3.png")
(define mov4 "b4.png")
(define mov1l "b1l.png")
(define mov2l "b2l.png")
(define mov3l "b3l.png")
(define mov4l "b4l.png")
(define bala1r "bala1r.png")
(define bala1l "bala1l.png")

(define (mov-img-zombie-left x)
  (cond
    ((= x 0) z1)
    ((= x 1) z1)
    ((= x 2) z1)
    ((= x 3) z1)
    )
  )
(define (mov-img-burns-right x)
  (cond
    ((= x 0) mov1)
    ((= x 1) mov2)
    ((= x 2) mov3)
    ((= x 3) mov4)
    )
  )

(define (mov-img-burns-left x)
  (cond
    ((= x 0) mov1l)
    ((= x 1) mov2l)
    ((= x 2) mov3l)
    ((= x 3) mov4l)
    )
  )

(define (mov-img-bala x)
  (cond
    ((= x 0) bala1r)
    ((= x 1) bala1l)
    )
  )

(define (mov-burns-right  x y)
  (if (or (equal? (key-value (get-key-press ventana)) 'left) (= y 4))
      (consola x 0 (key-value (get-key-press ventana)))
      (begin
        ((draw-pixmap fondo) "back3.png" (make-posn 0 0)) 
        (((draw-pixmap-posn (mov-img-burns-right (remainder y 4))) fondo) (make-posn x 90))
        (copy-viewport fondo ventana)
        (clear-viewport fondo)
        (mov-burns-right  (+ x 10)  (+ y 1) )
        )
      )
  )

(define (mov-burns-left   x y)
  (if (or (equal? (key-value (get-key-press ventana)) 'right) (= y 4))
      (consola x 0 (key-value (get-key-press ventana)))
      (begin
        ((draw-pixmap fondo) "back3.png" (make-posn 0 0)) 
        (((draw-pixmap-posn (mov-img-burns-left (remainder y 4))) fondo) (make-posn x 90))
        (copy-viewport fondo ventana)
        (clear-viewport fondo)
        (mov-burns-left   (- x 10)  (+ y 1) )
        )
      )  
  )

(define (mov-bala-left  x y )
  (if (or  (>= x 480) (<= x -330))
      (consola y 0 (key-value (get-key-press ventana)))
      (begin
        ((draw-pixmap fondo) "back3.png" (make-posn 0 0))
        (((draw-pixmap-posn (mov-img-burns-left 3)) fondo) (make-posn y 90))
        (((draw-pixmap-posn (mov-img-bala 1)) fondo) (make-posn x 90))
        (copy-viewport fondo ventana)
        (clear-viewport fondo)
        (mov-bala-left  (- x 90) y )
        )
      )
  )

(define (mov-bala-right  x y)
 (if (or (>= x 480) (<= x -330))
      (consola y 0 (key-value (get-key-press ventana)))
      (begin
        ((draw-pixmap fondo) "back3.png" (make-posn 0 0))
        (((draw-pixmap-posn (mov-img-burns-right 3)) fondo) (make-posn y 90))
        (((draw-pixmap-posn (mov-img-bala 0)) fondo) (make-posn x 90))
        (copy-viewport fondo ventana)
        (clear-viewport fondo)
        (mov-bala-right  (+ x 90) y )
        )
      ))

(define (mov-zombie x t)
  (if (not (= t 0))
      (begin
        ((draw-pixmap fondo) "back3.png" (make-posn 0 0))
        (((draw-pixmap-posn (mov-zombie 0)) fondo) (make-posn x 90))
        (copy-viewport fondo ventana)
        (clear-viewport fondo)
        )
      )
  )
(define (consola x y press) 
  (cond
    ( (and (> x -290) (equal? press 'left))  (mov-burns-left   x y))
    ( (and (< x 440)(equal? press 'right)) (mov-burns-right  x y))
    ( (equal? press 'up) (mov-bala-right  x x))
    ( (equal? press 'down) (mov-bala-left  x x))
    (else (consola x y (key-value (get-key-press ventana))))
    )
  )


      
(consola  75 1 'left)

